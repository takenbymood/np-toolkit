LAMMPS (16 Feb 2016)

# set up our simulation environment
dimension		3
units			lj
atom_style		hybrid sphere dipole
boundary		p p p

#input data file

read_data			"/Users/joelforster/Projects/np-toolkit/data/sp_data.data"
  orthogonal box = (-24.7314 -24.8449 -100) to (24.7314 24.8449 100)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  2925 atoms
  reading velocities ...
  2925 velocities


#group particles according to their types

group		mem			type 1
2900 atoms in group mem
group		vehicle		type 2
1 atoms in group vehicle
group		ligand 		type 3:26
24 atoms in group ligand
group		np      	type 2:26
25 atoms in group np

#give our particle a small kick towards the membrane

velocity	np	set 0 0 -2

#membrane parameters (see Yuan 2011)
variable	rc			equal	2.6
variable	rmin		equal	1.122462
variable	rclus		equal	2.0
variable	mu			equal	3
variable	zeta		equal	4
variable	eps			equal	4.34
variable	sigma		equal	1.00
variable	theta0_11	equal	0
variable 	memsize equal "count(mem)"

# nanoparticle parameters

variable	peps		equal	25.0

# set up additional variables to be computed during the simulation (see lammps wiki for full explainations)

#compute 		1 		all 		pair lj/cut epair
compute 		cls 	all 		cluster/atom ${rclus}
compute 		cls 	all 		cluster/atom 2
compute 		ct 		all 		temp/sphere
compute_modify 	ct 		extra 		${memsize}
compute_modify 	ct 		extra 		2900

# set up the pair style for the membrane

pair_style	hybrid		membrane ${rc}	lj/cut 5.04
pair_style	hybrid		membrane 2.6	lj/cut 5.04

# membrane-nanoparticle interactions, each is set separately so any distribution of ligand strengths is possible

pair_coeff		*	*	lj/cut		0.0				0.0	0.0
pair_coeff		1	2	lj/cut		100				4.0	4.45
pair_coeff		1	3	lj/cut		${peps}			1	1.8
pair_coeff		1	3	lj/cut		25			1	1.8
pair_coeff		1	4	lj/cut		${peps}			1	1.8
pair_coeff		1	4	lj/cut		25			1	1.8
pair_coeff		1	5	lj/cut		${peps}			1	1.8
pair_coeff		1	5	lj/cut		25			1	1.8
pair_coeff		1	6	lj/cut		${peps}			1	1.8
pair_coeff		1	6	lj/cut		25			1	1.8
pair_coeff		1	7	lj/cut		${peps}			1	1.8
pair_coeff		1	7	lj/cut		25			1	1.8
pair_coeff		1	8	lj/cut		${peps}			1	1.8
pair_coeff		1	8	lj/cut		25			1	1.8
pair_coeff		1	9	lj/cut		${peps}			1	1.8
pair_coeff		1	9	lj/cut		25			1	1.8
pair_coeff		1	10	lj/cut		${peps}			1	1.8
pair_coeff		1	10	lj/cut		25			1	1.8
pair_coeff		1	11	lj/cut		${peps}			1	1.8
pair_coeff		1	11	lj/cut		25			1	1.8
pair_coeff		1	12	lj/cut		${peps}			1	1.8
pair_coeff		1	12	lj/cut		25			1	1.8
pair_coeff		1	13	lj/cut		${peps}			1	1.8
pair_coeff		1	13	lj/cut		25			1	1.8
pair_coeff		1	14	lj/cut		${peps}			1	1.8
pair_coeff		1	14	lj/cut		25			1	1.8
pair_coeff		1	15	lj/cut		${peps}			1	1.8
pair_coeff		1	15	lj/cut		25			1	1.8
pair_coeff		1	16	lj/cut		${peps}			1	1.8
pair_coeff		1	16	lj/cut		25			1	1.8
pair_coeff		1	17	lj/cut		${peps}			1	1.8
pair_coeff		1	17	lj/cut		25			1	1.8
pair_coeff		1	18	lj/cut		${peps}			1	1.8
pair_coeff		1	18	lj/cut		25			1	1.8
pair_coeff		1	19	lj/cut		${peps}			1	1.8
pair_coeff		1	19	lj/cut		25			1	1.8
pair_coeff		1	20	lj/cut		${peps}			1	1.8
pair_coeff		1	20	lj/cut		25			1	1.8
pair_coeff		1	21	lj/cut		${peps}			1	1.8
pair_coeff		1	21	lj/cut		25			1	1.8
pair_coeff		1	22	lj/cut		${peps}			1	1.8
pair_coeff		1	22	lj/cut		25			1	1.8
pair_coeff		1	23	lj/cut		${peps}			1	1.8
pair_coeff		1	23	lj/cut		25			1	1.8
pair_coeff		1	24	lj/cut		${peps}			1	1.8
pair_coeff		1	24	lj/cut		25			1	1.8
pair_coeff		1	25	lj/cut		${peps}			1	1.8
pair_coeff		1	25	lj/cut		25			1	1.8
pair_coeff		1	26	lj/cut		${peps}			1	1.8
pair_coeff		1	26	lj/cut		25			1	1.8

#we set the interaction to zero at its cutoff distance, otherwise we will have a discontinuity

pair_modify		pair 	lj/cut	shift yes

#membrane-membrane interactions (these can be changed by messing with the variables at the top)

pair_coeff		1	1	membrane ${eps} ${sigma} ${rmin} ${rc} ${zeta} ${mu} ${theta0_11}
pair_coeff		1	1	membrane 4.34 ${sigma} ${rmin} ${rc} ${zeta} ${mu} ${theta0_11}
pair_coeff		1	1	membrane 4.34 1 ${rmin} ${rc} ${zeta} ${mu} ${theta0_11}
pair_coeff		1	1	membrane 4.34 1 1.122462 ${rc} ${zeta} ${mu} ${theta0_11}
pair_coeff		1	1	membrane 4.34 1 1.122462 2.6 ${zeta} ${mu} ${theta0_11}
pair_coeff		1	1	membrane 4.34 1 1.122462 2.6 4 ${mu} ${theta0_11}
pair_coeff		1	1	membrane 4.34 1 1.122462 2.6 4 3 ${theta0_11}
pair_coeff		1	1	membrane 4.34 1 1.122462 2.6 4 3 0

neigh_modify	every 1	delay 1	exclude group np np

# we set up the integration parameters

fix			fLANG		all		langevin 1.0 1.0 1.0 1000 zero yes omega yes
fix			fNPH		mem		nph/sphere	x 0.0 0.0 10.0	y 0.0 0.0 10.0 couple xy update dipole dilate all
fix_modify	fNPH		temp ct press thermo_press
fix			fRIGID		np		rigid/nve	group 1 np
1 rigid bodies with 25 atoms

#output settings, changing peps will change the output file name as well, change this by removing ${peps} from the dump file name

dump			coords all custom 100 particle_${peps}_out.xyz id type x y z c_cls
dump			coords all custom 100 particle_25_out.xyz id type x y z c_cls
dump_modify	coords sort id

thermo_style	custom	step pe ke etotal

# set up our timestep and runtime

timestep       0.01
thermo         100
run            25000
Neighbor list info ...
  4 neighbor list requests
  update every 1 steps, delay 1 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.75
  ghost atom cutoff = 4.75
  binsize = 2.375 -> bins = 21 21 85
Memory usage per processor = 6.32751 Mbytes
Step PotEng KinEng TotEng 
       0   -11.979473 0.0089504064   -11.970522 
     100   -12.438074    1.2493749   -11.188699 
     200   -12.165299    1.3752851   -10.790013 
     300   -11.995244    1.4549685   -10.540275 
     400   -12.008875     1.476094   -10.532781 
     500   -11.920048    1.5055621   -10.414486 
     600    -11.94646    1.5051026   -10.441357 
     700   -11.942104    1.4828098   -10.459294 
     800   -11.972992     1.487628   -10.485364 
     900   -11.963373    1.4865096   -10.476863 
    1000    -12.01014    1.4832402   -10.526899 
    1100   -11.946975    1.4860391   -10.460936 
    1200   -12.018074    1.4689037    -10.54917 
    1300   -12.145739    1.5224573   -10.623282 
    1400   -12.243577    1.5655835   -10.677994 
    1500   -12.303193    1.5643493   -10.738843 
    1600   -12.419288    1.5460142   -10.873273 
    1700   -12.422132    1.5047647   -10.917367 
    1800   -12.591209    1.4903664   -11.100843 
    1900   -12.640456    1.4969697   -11.143486 
    2000   -12.701437     1.517392   -11.184045 
    2100   -12.657062    1.5289995   -11.128062 
    2200   -12.766747    1.5300211   -11.236726 
    2300   -12.819472    1.4807048   -11.338767 
    2400   -12.781356    1.4988891   -11.282467 
    2500   -12.809809    1.5157123   -11.294097 
    2600   -12.878207    1.5318363   -11.346371 
    2700   -12.864842    1.5346847   -11.330157 
    2800   -12.886142    1.5120276   -11.374115 
    2900   -12.960454    1.5005686   -11.459886 
    3000   -12.939714    1.4729028   -11.466811 
    3100   -12.966117    1.4606929   -11.505424 
    3200   -13.007708    1.4874879    -11.52022 
    3300   -13.014457    1.5382875   -11.476169 
    3400   -12.915995    1.4649298   -11.451065 
    3500   -12.947422    1.4685058   -11.478916 
    3600   -13.032544    1.5150753   -11.517469 
    3700   -12.994599    1.4651855   -11.529414 
    3800   -13.061574    1.4988955   -11.562678 
    3900   -13.021956    1.5298974   -11.492058 
    4000   -13.001988    1.5464347   -11.455554 
    4100   -12.967599    1.5095842   -11.458015 
    4200   -13.026024    1.5123582   -11.513666 
    4300   -13.000591    1.5042622   -11.496329 
    4400   -13.074669    1.4907732   -11.583896 
    4500    -13.02824    1.4799424   -11.548298 
    4600    -12.98493    1.4836518   -11.501278 
    4700   -13.109259    1.4758328   -11.633426 
    4800    -13.06852    1.4823224   -11.586197 
    4900   -13.071364    1.4977709   -11.573593 
    5000   -13.098155    1.5041452    -11.59401 
    5100   -13.033813    1.5189567   -11.514856 
    5200   -13.045535    1.5322431   -11.513292 
    5300   -13.029852    1.5118951   -11.517956 
    5400   -13.086187    1.4903465   -11.595841 
    5500   -13.057463    1.5148199   -11.542644 
    5600   -13.060693    1.5307718   -11.529921 
    5700    -13.08443    1.4991336   -11.585296 
    5800   -13.116853    1.4638785   -11.652975 
    5900   -13.095696    1.4950763    -11.60062 
    6000    -13.08626    1.4920372   -11.594223 
    6100   -13.078875    1.5448776   -11.533998 
    6200   -13.028455    1.4927454    -11.53571 
    6300   -13.053427    1.5026392   -11.550787 
    6400   -13.041659    1.5120365   -11.529622 
    6500   -13.106435    1.4847378   -11.621697 
    6600   -13.119468      1.49356   -11.625908 
    6700   -13.108193    1.4750546   -11.633139 
    6800   -13.149286    1.4833633   -11.665923 
    6900    -13.07339    1.4798865   -11.593504 
    7000   -13.110519     1.497019     -11.6135 
    7100   -13.083491    1.4717238   -11.611767 
    7200   -13.102538     1.486252   -11.616286 
    7300   -13.045978    1.5076978    -11.53828 
    7400   -13.013054    1.4778971   -11.535156 
    7500   -13.089346    1.4954663   -11.593879 
    7600   -13.119921    1.4893469   -11.630574 
    7700   -13.036075    1.4756231   -11.560452 
    7800   -13.054175    1.5050442   -11.549131 
    7900   -13.111694    1.4729803   -11.638714 
    8000   -13.086707     1.504793   -11.581914 
    8100   -13.102838    1.5023358   -11.600502 
    8200   -13.096375    1.4874008   -11.608974 
    8300    -13.13206    1.5371575   -11.594902 
    8400   -13.072264    1.5108974   -11.561367 
    8500    -13.08603    1.5196573   -11.566372 
    8600   -13.049409     1.470045   -11.579364 
    8700   -13.068505    1.5381629   -11.530342 
    8800   -13.059603    1.5039593   -11.555644 
    8900   -13.124089    1.4934637   -11.630625 
    9000    -13.05722    1.4815115   -11.575708 
    9100   -13.052045    1.4824765   -11.569568 
    9200   -13.082027    1.4698752   -11.612152 
    9300   -13.054194    1.4914982   -11.562696 
    9400   -13.091423    1.5199087   -11.571515 
    9500   -13.077608    1.4948683   -11.582739 
    9600   -13.089721    1.4932885   -11.596432 
    9700   -13.096152    1.4742071   -11.621945 
    9800   -13.095994    1.5019747   -11.594019 
    9900    -13.05872     1.505116   -11.553604 
   10000   -13.085709    1.5007962   -11.584913 
   10100   -13.097351    1.4756461   -11.621705 
   10200   -13.140464    1.5120386   -11.628425 
   10300   -13.141586    1.4652177   -11.676368 
   10400   -13.119295    1.4389935   -11.680301 
   10500   -13.159966    1.4934245   -11.666541 
   10600   -13.053627    1.4899691   -11.563657 
   10700   -13.116701    1.5044275   -11.612273 
   10800   -13.080862    1.5082156   -11.572647 
   10900    -13.09989    1.4772657   -11.622624 
   11000   -13.109301    1.5060464   -11.603254 
   11100   -13.137322    1.5201643   -11.617157 
   11200   -13.085027     1.466325   -11.618702 
   11300   -13.034829    1.5097961   -11.525033 
   11400   -13.119768    1.4982891   -11.621479 
   11500     -13.1467    1.4727413   -11.673959 
   11600   -13.077155    1.4987373   -11.578417 
   11700   -13.135778    1.4997317   -11.636047 
   11800   -13.143262     1.470052    -11.67321 
   11900   -13.110134    1.4332986   -11.676835 
   12000   -13.082556    1.4785566   -11.603999 
   12100    -13.11998    1.4759277   -11.644052 
   12200   -13.134201    1.4477602   -11.686441 
   12300   -13.153535    1.4629828   -11.690552 
   12400    -13.10449    1.5052633   -11.599226 
   12500   -13.071224    1.5027104   -11.568514 
   12600   -13.129766    1.5171531   -11.612613 
   12700   -13.118968    1.4847416   -11.634226 
   12800   -13.054313    1.4798776   -11.574435 
   12900   -13.104912    1.4932273   -11.611685 
   13000    -13.13163    1.5016579   -11.629972 
   13100   -13.036945    1.5104755   -11.526469 
   13200   -13.090952    1.4552776   -11.635674 
   13300   -13.123555    1.5080569   -11.615499 
   13400   -13.049734    1.4676348   -11.582099 
   13500    -13.05677    1.4886366   -11.568133 
   13600   -13.074781     1.483303   -11.591478 
   13700   -13.131389    1.5442924   -11.587096 
   13800   -13.054707    1.4871414   -11.567566 
   13900   -13.116313    1.5221518   -11.594161 
   14000   -13.097498     1.496624   -11.600874 
   14100   -13.167669    1.4868795   -11.680789 
   14200     -13.1374    1.5036186   -11.633781 
   14300   -13.179745    1.4766607   -11.703084 
   14400   -13.115298    1.4797796   -11.635519 
   14500   -13.106783    1.4669778   -11.639806 
   14600   -13.076006    1.4567448   -11.619262 
   14700   -13.132542    1.5093512   -11.623191 
   14800   -13.088388    1.5155722   -11.572816 
   14900   -13.077954    1.4915165   -11.586437 
   15000    -13.13065    1.4893577   -11.641292 
   15100   -13.099673      1.49902   -11.600653 
   15200    -13.02969    1.5155709   -11.514119 
   15300   -13.016399      1.51494   -11.501459 
   15400   -13.106255    1.5042263   -11.602029 
   15500   -13.078686    1.4880089   -11.590677 
   15600   -13.093926    1.4920248   -11.601901 
   15700   -13.098186    1.5047931   -11.593393 
   15800   -13.050572     1.480307   -11.570265 
   15900   -13.067727    1.5027654   -11.564961 
   16000   -13.100362    1.5363596   -11.564002 
   16100   -13.112512    1.5221029   -11.590409 
   16200   -13.143503    1.4984462   -11.645057 
   16300   -13.128675    1.5043022   -11.624373 
   16400   -13.052031    1.4884494   -11.563581 
   16500   -13.097728     1.492758    -11.60497 
   16600   -13.112877    1.5442381   -11.568639 
   16700   -13.075788    1.5065376    -11.56925 
   16800     -13.0923    1.5068285   -11.585472 
   16900    -13.12157    1.5179673   -11.603602 
   17000   -13.148689    1.5092078   -11.639481 
   17100   -13.100066    1.5005737   -11.599492 
   17200   -13.120726      1.51216   -11.608566 
   17300   -13.146627    1.5463572    -11.60027 
   17400   -13.115141    1.5336808    -11.58146 
   17500   -13.075696    1.5170702   -11.558626 
   17600   -13.146104    1.5337383   -11.612366 
   17700   -13.099008    1.4898127   -11.609195 
   17800   -13.148799    1.5021609   -11.646638 
   17900   -13.075707    1.5266317   -11.549076 
   18000   -13.065858    1.5068938   -11.558964 
   18100   -13.126828    1.4967618   -11.630066 
   18200   -13.121217    1.4775272    -11.64369 
   18300   -13.095168    1.4986229   -11.596545 
   18400    -13.06749    1.5076012   -11.559889 
   18500   -13.108274    1.5096844   -11.598589 
   18600   -13.081095    1.4901113   -11.590984 
   18700   -13.148721    1.4900923   -11.658629 
   18800   -13.142562    1.5071464   -11.635416 
   18900   -13.095359    1.4976566   -11.597703 
   19000   -13.098281    1.4754626   -11.622819 
   19100   -13.153037    1.4713062   -11.681731 
   19200   -13.090202    1.5168443   -11.573357 
   19300    -13.08197    1.5198106    -11.56216 
   19400   -13.088065    1.4865135   -11.601552 
   19500   -13.119547    1.4755164   -11.644031 
   19600   -13.113334    1.4430126   -11.670321 
   19700    -13.11067    1.4781584   -11.632511 
   19800   -13.113534    1.4643761   -11.649158 
   19900   -13.152538    1.4633087   -11.689229 
   20000   -13.066238    1.4822991   -11.583939 
   20100   -13.101302    1.4879724   -11.613329 
   20200   -13.114751    1.4704343   -11.644317 
   20300   -13.147519    1.4828861   -11.664633 
   20400   -13.102646    1.4628862    -11.63976 
   20500    -13.07851    1.5184618   -11.560048 
   20600   -13.112935    1.4734474   -11.639488 
   20700   -13.088676    1.4774362    -11.61124 
   20800   -13.129706    1.5316771   -11.598029 
   20900   -13.117948     1.506782   -11.611166 
   21000   -13.057558    1.4855052   -11.572053 
   21100   -13.112495    1.4994262   -11.613069 
   21200    -13.10582    1.5043886   -11.601431 
   21300   -13.137186    1.5448665    -11.59232 
   21400   -13.167425    1.5206861   -11.646739 
   21500   -13.134415    1.4790413   -11.655374 
   21600   -13.163707    1.5262771    -11.63743 
   21700    -13.09104    1.5135929   -11.577447 
   21800   -13.111398    1.5287565   -11.582641 
   21900   -13.127287    1.4971231   -11.630164 
   22000   -13.101951    1.5177661   -11.584185 
   22100   -13.104459    1.5074939   -11.596965 
   22200    -13.12983    1.5488266   -11.581004 
   22300   -13.086572    1.5037959   -11.582776 
   22400   -13.026209    1.4966914   -11.529517 
   22500   -13.067651    1.4900987   -11.577552 
   22600   -13.065688      1.48754   -11.578148 
   22700    -13.10133    1.4971727   -11.604157 
   22800   -13.094352    1.4926585   -11.601693 
   22900   -13.124222    1.5309723   -11.593249 
   23000   -13.133323    1.5163371   -11.616986 
   23100   -13.173284    1.5207067   -11.652577 
   23200   -13.045518    1.4782677    -11.56725 
   23300   -13.123116    1.4890821   -11.634034 
   23400   -13.067929    1.4691087    -11.59882 
   23500   -13.099256    1.5038662    -11.59539 
   23600   -13.144024    1.4977574   -11.646267 
   23700   -13.122217    1.4380351   -11.684182 
   23800   -13.122519    1.4803844   -11.642134 
   23900   -13.114528    1.4884067   -11.626121 
   24000   -13.136937    1.5206854   -11.616251 
   24100   -13.100701    1.5375066   -11.563194 
   24200   -13.069032    1.4988665   -11.570166 
   24300   -13.076606    1.4610195   -11.615587 
   24400   -13.102146    1.4831261    -11.61902 
   24500   -13.128178    1.4721533   -11.656024 
   24600   -13.119937    1.4895052   -11.630432 
   24700    -13.14955    1.4894021   -11.660148 
   24800   -13.086654    1.5116515   -11.575002 
   24900   -13.002973     1.490776   -11.512197 
   25000   -13.058712    1.4913296   -11.567382 
Loop time of 104.946 on 1 procs for 25000 steps with 2925 atoms

Performance: 205819.218 tau/day, 238.217 timesteps/s
99.6% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.527     | 74.527     | 74.527     |   0.0 | 71.01
Neigh   | 21.242     | 21.242     | 21.242     |   0.0 | 20.24
Comm    | 0.6767     | 0.6767     | 0.6767     |   0.0 |  0.64
Output  | 2.0104     | 2.0104     | 2.0104     |   0.0 |  1.92
Modify  | 6.2001     | 6.2001     | 6.2001     |   0.0 |  5.91
Other   |            | 0.2902     |            |       |  0.28

Nlocal:    2925 ave 2925 max 2925 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1158 ave 1158 max 1158 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    43499 ave 43499 max 43499 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  87086 ave 87086 max 87086 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 87086
Ave neighs/atom = 29.773
Neighbor list builds = 8716
Dangerous builds = 8
Total wall time: 0:01:45
